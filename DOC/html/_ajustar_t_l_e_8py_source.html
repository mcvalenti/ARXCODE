<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ARxCODE: AjustarTLE/AjustarTLE.py Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ARxCODE
   
   </div>
   <div id="projectbrief">Analisis de Riesgo por Colision con Desechos Espaciales.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_ajustar_t_l_e_8py.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">AjustarTLE/AjustarTLE.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_ajustar_t_l_e_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html">00001</a> <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00002"></a>00002 <span class="stringliteral">Created on Aug 26, 2016</span>
<a name="l00003"></a>00003 <span class="stringliteral"></span>
<a name="l00004"></a>00004 <span class="stringliteral">Toma 10 tles de un archivo y realiza un metodo de ajuste,</span>
<a name="l00005"></a>00005 <span class="stringliteral">a fin de obtener una matriz de covarianza con el error.</span>
<a name="l00006"></a>00006 <span class="stringliteral"></span>
<a name="l00007"></a>00007 <span class="stringliteral">@author: mcvalenti</span>
<a name="l00008"></a>00008 <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00009"></a>00009 <span class="keyword">import</span> glob, os
<a name="l00010"></a>00010 <span class="keyword">import</span> operator
<a name="l00011"></a>00011 <span class="keyword">import</span> numpy <span class="keyword">as</span> np
<a name="l00012"></a>00012 <span class="keyword">import</span> numpy.polynomial <span class="keyword">as</span> P
<a name="l00013"></a>00013 <span class="keyword">import</span> matplotlib.pylab <span class="keyword">as</span> plt
<a name="l00014"></a>00014 <span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timedelta
<a name="l00015"></a>00015 <span class="keyword">from</span> sgp4.earth_gravity <span class="keyword">import</span> wgs72
<a name="l00016"></a>00016 <span class="keyword">from</span> sgp4.io <span class="keyword">import</span> twoline2rv
<a name="l00017"></a>00017 <span class="keyword">from</span> TleAdmin.TleArchivos <span class="keyword">import</span> divide_setTLE
<a name="l00018"></a>00018 <span class="keyword">from</span> TleAdmin.TLE <span class="keyword">import</span> Tle
<a name="l00019"></a>00019 <span class="keyword">from</span> SistReferencia.sist_deCoordenadas <span class="keyword">import</span> vncSis, ricSis, teme2tod
<a name="l00020"></a>00020 <span class="keyword">from</span> Estadistica.ajusteMinCuad <span class="keyword">import</span> ajustar_diferencias
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#aa379e880455c19bcde9490860b81d4b0">00023</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#aa379e880455c19bcde9490860b81d4b0">seleccionSat</a>():
<a name="l00024"></a>00024     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00025"></a>00025 <span class="stringliteral">    --------------------------------------------------------</span>
<a name="l00026"></a>00026 <span class="stringliteral">    Preprocesamiento del dato crudo bajado de Space-track</span>
<a name="l00027"></a>00027 <span class="stringliteral">    Preparacion de los archivos TLE, para el procesamiento.</span>
<a name="l00028"></a>00028 <span class="stringliteral">    La funcion busca en la carpeta TleAdmin/crudosTLE.</span>
<a name="l00029"></a>00029 <span class="stringliteral">    (el archivo debe contener solo las lineas de los tle)</span>
<a name="l00030"></a>00030 <span class="stringliteral">    La funcion guarda los archivos tle generados en la carpeta</span>
<a name="l00031"></a>00031 <span class="stringliteral">    TleAdmin/tle</span>
<a name="l00032"></a>00032 <span class="stringliteral">    -------------------------------------------------------------</span>
<a name="l00033"></a>00033 <span class="stringliteral">    input</span>
<a name="l00034"></a>00034 <span class="stringliteral">        xxxx_fechainicio_fechafin:  archivo de texto plano </span>
<a name="l00035"></a>00035 <span class="stringliteral">        (xxxx corresponde al cat_id del satelite de interes)</span>
<a name="l00036"></a>00036 <span class="stringliteral">    output</span>
<a name="l00037"></a>00037 <span class="stringliteral">        tle#: lista de archivos con 1 TLE por fecha.</span>
<a name="l00038"></a>00038 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00039"></a>00039     satelites_datos=glob.glob(<span class="stringliteral">&#39;../TleAdmin/crudosTLE/*&#39;</span>)
<a name="l00040"></a>00040     nombres=[]
<a name="l00041"></a>00041  
<a name="l00042"></a>00042     condicion=<span class="keyword">True</span>
<a name="l00043"></a>00043      
<a name="l00044"></a>00044     while(condicion):
<a name="l00045"></a>00045         <span class="keywordflow">for</span> arch <span class="keywordflow">in</span> satelites_datos:
<a name="l00046"></a>00046             nombre_archivo=arch.split(<span class="stringliteral">&#39;/&#39;</span>)[-1]
<a name="l00047"></a>00047             <span class="keywordflow">print</span> nombre_archivo
<a name="l00048"></a>00048             nombres.append(nombre_archivo)
<a name="l00049"></a>00049         <span class="keywordflow">print</span> <span class="stringliteral">&quot;Seleccione el Satelite a analizar&quot;</span>
<a name="l00050"></a>00050         
<a name="l00051"></a>00051         
<a name="l00052"></a>00052         crudo=raw_input()
<a name="l00053"></a>00053         id_sat=crudo.split(<span class="stringliteral">&#39;_&#39;</span>)[0]
<a name="l00054"></a>00054          
<a name="l00055"></a>00055         <span class="keywordflow">if</span> crudo <span class="keywordflow">in</span> nombres:
<a name="l00056"></a>00056             <a class="code" href="namespace_tle_admin_1_1_tle_archivos.html#ae8fa5020f6a4cd74f6506d6b3a26422f">divide_setTLE</a>(id_sat, crudo)
<a name="l00057"></a>00057             condicion=<span class="keyword">False</span>
<a name="l00058"></a>00058         <span class="keywordflow">else</span>:
<a name="l00059"></a>00059             <span class="keywordflow">print</span> <span class="stringliteral">&#39;-------------------------------&#39;</span>
<a name="l00060"></a>00060             <span class="keywordflow">print</span> <span class="stringliteral">&quot;Error en el nombre del archivo&quot;</span>
<a name="l00061"></a>00061             <span class="keywordflow">print</span> <span class="stringliteral">&#39;--------------------------------&#39;</span>
<a name="l00062"></a>00062             <span class="keywordflow">print</span> <span class="stringliteral">&#39;...&#39;</span>
<a name="l00063"></a>00063          
<a name="l00064"></a>00064     <span class="keywordflow">print</span> <span class="stringliteral">&#39;El archivo seleccionado es = &#39;</span>, crudo
<a name="l00065"></a>00065     <span class="keywordflow">print</span> <span class="stringliteral">&#39;Ud. Selecciono el satelite con ID= &#39;</span>, id_sat  
<a name="l00066"></a>00066     <span class="keywordflow">return</span> crudo
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#ac352fb5d30dae7100bfa677e5a33fb7b">00069</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#ac352fb5d30dae7100bfa677e5a33fb7b">generadorDatos</a>(lista):
<a name="l00070"></a>00070     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00071"></a>00071 <span class="stringliteral">    ----------------------------------------------------------------------</span>
<a name="l00072"></a>00072 <span class="stringliteral">    Genera un diccionario, cuyas claves son tle1, tle2, tle3...tle10</span>
<a name="l00073"></a>00073 <span class="stringliteral">    y para cada campo, se indica la fecha del tle asociado.</span>
<a name="l00074"></a>00074 <span class="stringliteral">    -----------------------------------------------------------------------</span>
<a name="l00075"></a>00075 <span class="stringliteral">    input</span>
<a name="l00076"></a>00076 <span class="stringliteral">        lista: lista de nombres de los archivos del directorio &#39;tle&#39; - (string)</span>
<a name="l00077"></a>00077 <span class="stringliteral">    output</span>
<a name="l00078"></a>00078 <span class="stringliteral">        tledic: diccionario</span>
<a name="l00079"></a>00079 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00080"></a>00080     tledic={}
<a name="l00081"></a>00081     datos=[]
<a name="l00082"></a>00082     <span class="keywordflow">for</span> arch <span class="keywordflow">in</span> lista:
<a name="l00083"></a>00083         nombre=arch.split(<span class="stringliteral">&#39;/&#39;</span>)[-1]
<a name="l00084"></a>00084         tle=Tle.creadoxArchivo(arch) <span class="comment"># instancia un objeto de la clase  TLE</span>
<a name="l00085"></a>00085         datos.append(tle.epoca()) <span class="comment"># ejecuta un metodo de la clase TLE</span>
<a name="l00086"></a>00086         tledic[nombre]= datos
<a name="l00087"></a>00087         datos=[]
<a name="l00088"></a>00088     
<a name="l00089"></a>00089     <span class="keywordflow">return</span> tledic
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#af6f0f78d827900de034dde2317641d71">00091</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#af6f0f78d827900de034dde2317641d71">ordenaTles</a>(tledic):
<a name="l00092"></a>00092     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00093"></a>00093 <span class="stringliteral">    -----------------------------------------------------------------</span>
<a name="l00094"></a>00094 <span class="stringliteral">    Toma el diccionario de TLEs y los ordena de acuerdo a sus fechas.</span>
<a name="l00095"></a>00095 <span class="stringliteral">    -----------------------------------------------------------------</span>
<a name="l00096"></a>00096 <span class="stringliteral">    input</span>
<a name="l00097"></a>00097 <span class="stringliteral">        tledic: diccionario</span>
<a name="l00098"></a>00098 <span class="stringliteral">    output</span>
<a name="l00099"></a>00099 <span class="stringliteral">        tleOrdenados: lista de listas</span>
<a name="l00100"></a>00100 <span class="stringliteral">            tleOrdenados[0]: &#39;tle#&#39;, numero de tle (string)</span>
<a name="l00101"></a>00101 <span class="stringliteral">            tleOrdenados[1]: lista, (fecha)</span>
<a name="l00102"></a>00102 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00103"></a>00103     ve=open(<span class="stringliteral">&#39;verif&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00104"></a>00104     ve1=open(<span class="stringliteral">&#39;verif1&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00105"></a>00105     <span class="keywordflow">for</span> k,v <span class="keywordflow">in</span> tledic.iteritems():
<a name="l00106"></a>00106         info1=str(k)+<span class="stringliteral">&#39; &#39;</span>+str(v)+<span class="stringliteral">&#39;\n&#39;</span>
<a name="l00107"></a>00107         ve.write(info1)
<a name="l00108"></a>00108     tleOrdenados=sorted(tledic.items(), key=operator.itemgetter(1))
<a name="l00109"></a>00109     <span class="keywordflow">for</span> k <span class="keywordflow">in</span> tleOrdenados:
<a name="l00110"></a>00110         info2=str(k)+<span class="stringliteral">&#39;\n&#39;</span>
<a name="l00111"></a>00111         ve1.write(info2)
<a name="l00112"></a>00112     <span class="keywordflow">return</span> tleOrdenados
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a8d5188ab96d4fb7e38c637b837e15641">00115</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a8d5188ab96d4fb7e38c637b837e15641">tuplaFloat</a>(tupla):
<a name="l00116"></a>00116     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00117"></a>00117 <span class="stringliteral">    transforma las tuplas a sus componentes en flotante</span>
<a name="l00118"></a>00118 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00119"></a>00119     x=float(tupla[0])
<a name="l00120"></a>00120     y=float(tupla[1])
<a name="l00121"></a>00121     z=float(tupla[2])
<a name="l00122"></a>00122     
<a name="l00123"></a>00123     <span class="keywordflow">return</span> x,y,z
<a name="l00124"></a>00124 
<a name="l00125"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a94aec4b69038ea33ab79eb7889b35f52">00125</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a94aec4b69038ea33ab79eb7889b35f52">tlePrimario</a>(tlepri):
<a name="l00126"></a>00126     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00127"></a>00127 <span class="stringliteral">    -----------------------------------------------------------------</span>
<a name="l00128"></a>00128 <span class="stringliteral">    Devuelve el vector de estado y la epoca</span>
<a name="l00129"></a>00129 <span class="stringliteral">    correspondiente a la referencia como dato primario</span>
<a name="l00130"></a>00130 <span class="stringliteral">    -----------------------------------------------------------------</span>
<a name="l00131"></a>00131 <span class="stringliteral">    input</span>
<a name="l00132"></a>00132 <span class="stringliteral">        tlepri: nombre del archivo con el TLE primario (string)</span>
<a name="l00133"></a>00133 <span class="stringliteral">    output</span>
<a name="l00134"></a>00134 <span class="stringliteral">        r,v: vector posicion y velocidad para el TLE primario (array)</span>
<a name="l00135"></a>00135 <span class="stringliteral">        ffin: epoca del TLE primario (datetime)</span>
<a name="l00136"></a>00136 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00137"></a>00137     whichconst = wgs72
<a name="l00138"></a>00138     archivo=<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tlepri
<a name="l00139"></a>00139     tle0=Tle.creadoxArchivo(archivo)
<a name="l00140"></a>00140     line1=tle0.linea1
<a name="l00141"></a>00141     line2=tle0.linea2
<a name="l00142"></a>00142     r,v = tle0.propagaTLE()
<a name="l00143"></a>00143     satrec = twoline2rv(line1, line2, whichconst)
<a name="l00144"></a>00144     ffin=satrec.epoch
<a name="l00145"></a>00145 <span class="comment">#    r,v = sgp4(satrec,0)</span>
<a name="l00146"></a>00146     xf,yf,zf=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a8d5188ab96d4fb7e38c637b837e15641">tuplaFloat</a>(r)
<a name="l00147"></a>00147     xv,yv,zv=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a8d5188ab96d4fb7e38c637b837e15641">tuplaFloat</a>(v)
<a name="l00148"></a>00148     r=np.array([xf,yf,zf])
<a name="l00149"></a>00149     v=np.array([xv,yv,zv])
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="keywordflow">return</span> r,v,ffin
<a name="l00152"></a>00152 
<a name="l00153"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#aa9758327fe1e231138181cf4654d0bc3">00153</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#aa9758327fe1e231138181cf4654d0bc3">tleSecundario</a>(tlesec,ffin):
<a name="l00154"></a>00154     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00155"></a>00155 <span class="stringliteral">    ---------------------------------------------------------------------------------</span>
<a name="l00156"></a>00156 <span class="stringliteral">    Calcula la posicion del satelite propagada a la fecha del TLE primario.</span>
<a name="l00157"></a>00157 <span class="stringliteral">    ---------------------------------------------------------------------------------</span>
<a name="l00158"></a>00158 <span class="stringliteral">    input</span>
<a name="l00159"></a>00159 <span class="stringliteral">        tlesec: nombre del archivo que contiene el TLE secundario (string)</span>
<a name="l00160"></a>00160 <span class="stringliteral">    output</span>
<a name="l00161"></a>00161 <span class="stringliteral">        pos,vel: vector posicion y velocidad que resultan de la propagacion del</span>
<a name="l00162"></a>00162 <span class="stringliteral">                TLE secundario hasta la fecha del TLE primario (array)</span>
<a name="l00163"></a>00163 <span class="stringliteral">        fsec: epoca del TLE secundario</span>
<a name="l00164"></a>00164 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00165"></a>00165     whichconst = wgs72
<a name="l00166"></a>00166     archivo=<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tlesec
<a name="l00167"></a>00167     tle1=Tle.creadoxArchivo(archivo)
<a name="l00168"></a>00168     line1=tle1.linea1
<a name="l00169"></a>00169     line2=tle1.linea2
<a name="l00170"></a>00170     satrec1 = twoline2rv(line1, line2, whichconst)
<a name="l00171"></a>00171     ffin_anno=ffin.year
<a name="l00172"></a>00172     ffin_mes=ffin.month
<a name="l00173"></a>00173     ffin_dia=ffin.day
<a name="l00174"></a>00174     ffin_hora=ffin.hour
<a name="l00175"></a>00175     ffin_min=ffin.minute
<a name="l00176"></a>00176     ffin_s=ffin.second
<a name="l00177"></a>00177 <span class="comment">#    pos, vel = sgp4(satrec1,0)</span>
<a name="l00178"></a>00178     pos, vel=satrec1.propagate(ffin_anno, ffin_mes, ffin_dia, ffin_hora, ffin_min, ffin_s)
<a name="l00179"></a>00179     x,y,z=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a8d5188ab96d4fb7e38c637b837e15641">tuplaFloat</a>(pos)
<a name="l00180"></a>00180     vx,vy,vz=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a8d5188ab96d4fb7e38c637b837e15641">tuplaFloat</a>(vel)
<a name="l00181"></a>00181     pos=np.array([x,y,z])
<a name="l00182"></a>00182     vel=np.array([vx,vy,vz])
<a name="l00183"></a>00183     fsec=satrec1.epoch
<a name="l00184"></a>00184     <span class="keywordflow">return</span> pos,vel,fsec
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a4bebc343b4cce0cb101bd99f5c872b6b">00186</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a4bebc343b4cce0cb101bd99f5c872b6b">difTle</a>(tleOrdenados,cantidad_tles):
<a name="l00187"></a>00187     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00188"></a>00188 <span class="stringliteral">    ---------------------------------------------------------------</span>
<a name="l00189"></a>00189 <span class="stringliteral">    Diferencias de Osweiler. (Pair-Wise Differencing)</span>
<a name="l00190"></a>00190 <span class="stringliteral">    Calcula las diferencias entre TLE primario y secundarios</span>
<a name="l00191"></a>00191 <span class="stringliteral">    en el sistema v,n y c;  o (ric). </span>
<a name="l00192"></a>00192 <span class="stringliteral">    Lo hace en forma iterativa, recorriendo todos los TLE a fin</span>
<a name="l00193"></a>00193 <span class="stringliteral">    de que todos son primarios en algun momento.</span>
<a name="l00194"></a>00194 <span class="stringliteral">    ---------------------------------------------------------------</span>
<a name="l00195"></a>00195 <span class="stringliteral">    input:</span>
<a name="l00196"></a>00196 <span class="stringliteral">        tleOrdeandos: lista de TLEs y sus 2-lineas (lista de lista)</span>
<a name="l00197"></a>00197 <span class="stringliteral">    output:</span>
<a name="l00198"></a>00198 <span class="stringliteral">        difTotal# : archivo de texto plano (4 columnas) para cada set</span>
<a name="l00199"></a>00199 <span class="stringliteral">        [AjustarTLE/diferencias/difTotal_satID_fechaIni#]</span>
<a name="l00200"></a>00200 <span class="stringliteral">        bin : lista de listas, con las diferencias por bin. </span>
<a name="l00201"></a>00201 <span class="stringliteral">        data: lista de listas, [dt_frac,dv,dn,dc]</span>
<a name="l00202"></a>00202 <span class="stringliteral">    &quot;&quot;&quot;</span>  
<a name="l00203"></a>00203     
<a name="l00204"></a>00204     <span class="keywordflow">print</span> <span class="stringliteral">&#39;Procesando datos TLE...&#39;</span>
<a name="l00205"></a>00205     tles=glob.glob(<span class="stringliteral">&#39;../TleAdmin/tle/*&#39;</span>)
<a name="l00206"></a>00206     dic_tles=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#ac352fb5d30dae7100bfa677e5a33fb7b">generadorDatos</a>(tles)
<a name="l00207"></a>00207     tle_ordenados=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#af6f0f78d827900de034dde2317641d71">ordenaTles</a>(dic_tles)
<a name="l00208"></a>00208     
<a name="l00209"></a>00209     tle_inicio = <a class="code" href="class_tle_admin_1_1_t_l_e_1_1_tle.html">Tle</a>(<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tle_ordenados[0][0])
<a name="l00210"></a>00210     cat_id = tle_inicio.catID()
<a name="l00211"></a>00211     epoca_ini = tle_inicio.epoca()
<a name="l00212"></a>00212     
<a name="l00213"></a>00213     tle_primario = <a class="code" href="class_tle_admin_1_1_t_l_e_1_1_tle.html">Tle</a>(<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tle_ordenados[-1][0])
<a name="l00214"></a>00214     epoca_fin  = tle_primario.epoca()
<a name="l00215"></a>00215     epoca_ffin = epoca_fin
<a name="l00216"></a>00216     
<a name="l00217"></a>00217     nombre=<span class="stringliteral">&#39;difTot_&#39;</span>+str(cat_id)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ffin.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ini.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;.TLE&#39;</span>
<a name="l00218"></a>00218     nombre2=<span class="stringliteral">&#39;difTot_xyz_&#39;</span>+str(cat_id)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ffin.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ini.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;.TLE&#39;</span>
<a name="l00219"></a>00219     dtot=open(<span class="stringliteral">&#39;../AjustarTLE/diferencias/&#39;</span>+nombre+<span class="stringliteral">&#39;&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00220"></a>00220     dtot2=open(<span class="stringliteral">&#39;../AjustarTLE/diferencias/&#39;</span>+nombre2+<span class="stringliteral">&#39;&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00221"></a>00221     dt_tle=[]
<a name="l00222"></a>00222     dt_frac=[]
<a name="l00223"></a>00223     dv=[]
<a name="l00224"></a>00224     dn=[]
<a name="l00225"></a>00225     dc=[]
<a name="l00226"></a>00226     dvv=[]
<a name="l00227"></a>00227     dnn=[]
<a name="l00228"></a>00228     dcc=[]
<a name="l00229"></a>00229     dx=[]
<a name="l00230"></a>00230     dy=[]
<a name="l00231"></a>00231     dz=[]
<a name="l00232"></a>00232     dxx=[]
<a name="l00233"></a>00233     dyy=[]
<a name="l00234"></a>00234     dzz=[]
<a name="l00235"></a>00235     bin=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]]
<a name="l00236"></a>00236     m=0
<a name="l00237"></a>00237     <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(cantidad_tles-1,0,-1):       
<a name="l00238"></a>00238         tlepri=tleOrdenados[i][0]
<a name="l00239"></a>00239         r,rp,ffin=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a94aec4b69038ea33ab79eb7889b35f52">tlePrimario</a>(tlepri)     
<a name="l00240"></a>00240         item=range(i-1,-1,-1)       
<a name="l00241"></a>00241         <span class="keywordflow">for</span> j <span class="keywordflow">in</span> item:
<a name="l00242"></a>00242             tlesec=tleOrdenados[j][0]
<a name="l00243"></a>00243             pos,vel,fsec=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#aa9758327fe1e231138181cf4654d0bc3">tleSecundario</a>(tlesec, ffin)
<a name="l00244"></a>00244             dt_tle.append(fsec)
<a name="l00245"></a>00245             dr=pos-r
<a name="l00246"></a>00246             d_v=vel-rp
<a name="l00247"></a>00247             x=dr[0]
<a name="l00248"></a>00248             y=dr[1]
<a name="l00249"></a>00249             z=dr[2]
<a name="l00250"></a>00250             xx=d_v[0]
<a name="l00251"></a>00251             yy=d_v[1]
<a name="l00252"></a>00252             zz=d_v[2]
<a name="l00253"></a>00253             dt=abs(fsec-ffin)
<a name="l00254"></a>00254             dtfracdias=dt.total_seconds()/86400.0
<a name="l00255"></a>00255 <span class="comment">#             v,n,c=vncSis(r, rp, dr)</span>
<a name="l00256"></a>00256 <span class="comment">#             vv,nn,cc=vncSis(r,rp,d_v)</span>
<a name="l00257"></a>00257             v,n,c=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#a8eccb1d3c6c56a4c77b891b1da887dd7">ricSis</a>(r, rp, dr)
<a name="l00258"></a>00258             vv,nn,cc=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#a8eccb1d3c6c56a4c77b891b1da887dd7">ricSis</a>(r,rp,dv)
<a name="l00259"></a>00259             infodiftot=str(fsec)+<span class="stringliteral">&#39; &#39;</span>+str(v)+<span class="stringliteral">&#39; &#39;</span>+str(n)+<span class="stringliteral">&#39; &#39;</span>+str(c)+<span class="stringliteral">&#39; &#39;</span>+str(vv)+<span class="stringliteral">&#39; &#39;</span>+str(nn)+<span class="stringliteral">&#39; &#39;</span>+str(cc)+<span class="stringliteral">&#39; &#39;</span>+tlesec+<span class="stringliteral">&#39;\n&#39;</span>
<a name="l00260"></a>00260             infodiftot2=str(fsec)+<span class="stringliteral">&#39; &#39;</span>+str(x)+<span class="stringliteral">&#39; &#39;</span>+str(y)+<span class="stringliteral">&#39; &#39;</span>+str(z)+<span class="stringliteral">&#39; &#39;</span>+str(xx)+<span class="stringliteral">&#39; &#39;</span>+str(yy)+<span class="stringliteral">&#39; &#39;</span>+str(zz)+<span class="stringliteral">&#39; &#39;</span>+tlesec+<span class="stringliteral">&#39;\n&#39;</span>
<a name="l00261"></a>00261             dtot.write(infodiftot)
<a name="l00262"></a>00262             dtot2.write(infodiftot2)
<a name="l00263"></a>00263             dt_frac.append(dtfracdias)
<a name="l00264"></a>00264             <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00265"></a>00265 <span class="stringliteral">            Sistema VNC</span>
<a name="l00266"></a>00266 <span class="stringliteral">            &#39;&#39;&#39;</span>
<a name="l00267"></a>00267             dv.append(v)
<a name="l00268"></a>00268             dn.append(n)
<a name="l00269"></a>00269             dc.append(c)
<a name="l00270"></a>00270             dvv.append(vv)
<a name="l00271"></a>00271             dnn.append(nn)
<a name="l00272"></a>00272             dcc.append(cc)
<a name="l00273"></a>00273             <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00274"></a>00274 <span class="stringliteral">            Sistema TEMA</span>
<a name="l00275"></a>00275 <span class="stringliteral">            &#39;&#39;&#39;</span>
<a name="l00276"></a>00276             dx.append(x)
<a name="l00277"></a>00277             dy.append(y)
<a name="l00278"></a>00278             dz.append(z)
<a name="l00279"></a>00279             dxx.append(xx)
<a name="l00280"></a>00280             dyy.append(yy)
<a name="l00281"></a>00281             dzz.append(zz)           
<a name="l00282"></a>00282             <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00283"></a>00283 <span class="stringliteral">            Clasificacion por bin.</span>
<a name="l00284"></a>00284 <span class="stringliteral">            &quot;&quot;&quot;</span>
<a name="l00285"></a>00285             rangos=np.array([[0,0.5],[0.5,1.5],[1.5,2.5],[2.5,3.5],[3.5,4.5],
<a name="l00286"></a>00286                      [4.5,5.5],[5.5,6.5],[6.5,7.5],[7.5,8.5],[8.5,9.5],
<a name="l00287"></a>00287                      [9.5,10.5],[10.5,11.5],[11.5,12.5],[12.5,13.5],[13.5,14.5]])
<a name="l00288"></a>00288             <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(len(rangos)):
<a name="l00289"></a>00289                 <span class="keywordflow">if</span> dtfracdias &gt;= rangos[k][0] <span class="keywordflow">and</span> dtfracdias &lt; rangos[k][1]:
<a name="l00290"></a>00290                     bin[k].append(infodiftot)
<a name="l00291"></a>00291                     
<a name="l00292"></a>00292             
<a name="l00293"></a>00293         m=m+1 
<a name="l00294"></a>00294             
<a name="l00295"></a>00295     dataPri=[dt_tle[:15],dv[:15],dn[:15],dc[:15],
<a name="l00296"></a>00296              dvv[:15],dnn[:15],dcc[:15],dt_frac[:15]]    
<a name="l00297"></a>00297     data1=[dt_tle,dv,dn,dc,dvv,dnn,dnn,dt_frac]
<a name="l00298"></a>00298     
<a name="l00299"></a>00299     <span class="keywordflow">print</span> <span class="stringliteral">&#39;++++++++++++GRADO 2++++++++++++++++++&#39;</span>
<a name="l00300"></a>00300     dt,coef,statsReport=<a class="code" href="namespace_estadistica_1_1ajuste_min_cuad.html#aa33554754bf43adc6df315cff92367e1">ajustar_diferencias</a>(epoca_ffin,dataPri,2)
<a name="l00301"></a>00301     <span class="keywordflow">print</span> coef
<a name="l00302"></a>00302     <span class="keywordflow">print</span> statsReport
<a name="l00303"></a>00303     
<a name="l00304"></a>00304     <span class="keywordflow">print</span> <span class="stringliteral">&#39;++++++++++++GRADO 1++++++++++++++++++&#39;</span>
<a name="l00305"></a>00305     dt1,coef1,statsReport1=<a class="code" href="namespace_estadistica_1_1ajuste_min_cuad.html#aa33554754bf43adc6df315cff92367e1">ajustar_diferencias</a>(epoca_ffin,dataPri,1)
<a name="l00306"></a>00306     <span class="keywordflow">print</span> coef1
<a name="l00307"></a>00307     <span class="keywordflow">print</span> statsReport1
<a name="l00308"></a>00308     
<a name="l00309"></a>00309     data=[dt,data1,coef,nombre]
<a name="l00310"></a>00310         
<a name="l00311"></a>00311     dtot.close()
<a name="l00312"></a>00312     <span class="keywordflow">return</span> bin, data, dataPri, coef1
<a name="l00313"></a>00313 
<a name="l00314"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a0def211e83af5488e0e43a1719d44635">00314</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a0def211e83af5488e0e43a1719d44635">genera_estadisticaBin</a>(bin_lista):
<a name="l00315"></a>00315     
<a name="l00316"></a>00316     lista_k=[]
<a name="l00317"></a>00317     cantxbin=[]
<a name="l00318"></a>00318     mx_list=[]
<a name="l00319"></a>00319     my_list=[]
<a name="l00320"></a>00320     mz_list=[]
<a name="l00321"></a>00321     vx_list=[]
<a name="l00322"></a>00322     vy_list=[]
<a name="l00323"></a>00323     vz_list=[]
<a name="l00324"></a>00324     stdx_list=[]
<a name="l00325"></a>00325     stdy_list=[]
<a name="l00326"></a>00326     stdz_list=[]
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range(len(bin_lista)):
<a name="l00329"></a>00329         lista_k.append(k)
<a name="l00330"></a>00330         bin_x=[]
<a name="l00331"></a>00331         bin_y=[]
<a name="l00332"></a>00332         bin_z=[]
<a name="l00333"></a>00333         cantxbin.append(len(bin_lista[k]))
<a name="l00334"></a>00334         <span class="keywordflow">if</span> len(bin_lista[k]) &gt; 2:
<a name="l00335"></a>00335             <span class="keywordflow">for</span> m <span class="keywordflow">in</span> bin_lista[k]:
<a name="l00336"></a>00336                 campo=m.split(<span class="stringliteral">&#39; &#39;</span>)
<a name="l00337"></a>00337                 bin_x.append(float(campo[2]))
<a name="l00338"></a>00338                 bin_y.append(float(campo[3]))
<a name="l00339"></a>00339                 bin_z.append(float(campo[4]))
<a name="l00340"></a>00340                 
<a name="l00341"></a>00341             media_x=np.mean(bin_x)
<a name="l00342"></a>00342             mx_list.append(media_x)
<a name="l00343"></a>00343             media_y=np.mean(bin_y)
<a name="l00344"></a>00344             my_list.append(media_y)
<a name="l00345"></a>00345             media_z=np.mean(bin_z)
<a name="l00346"></a>00346             mz_list.append(media_z)
<a name="l00347"></a>00347             
<a name="l00348"></a>00348             varianza_x=np.var(bin_x)
<a name="l00349"></a>00349             vx_list.append(varianza_x)
<a name="l00350"></a>00350             varianza_y=np.var(bin_y)
<a name="l00351"></a>00351             vy_list.append(varianza_y)
<a name="l00352"></a>00352             varianza_z=np.var(bin_z)
<a name="l00353"></a>00353             vz_list.append(varianza_z)
<a name="l00354"></a>00354             
<a name="l00355"></a>00355             desviacion_x=np.std(bin_x)
<a name="l00356"></a>00356             stdx_list.append(desviacion_x)
<a name="l00357"></a>00357             desviacion_y=np.std(bin_y)
<a name="l00358"></a>00358             stdy_list.append(desviacion_y)
<a name="l00359"></a>00359             desviacion_z=np.std(bin_z)
<a name="l00360"></a>00360             stdz_list.append(desviacion_z)
<a name="l00361"></a>00361     
<a name="l00362"></a>00362     mediaxbin=[mx_list,my_list,mz_list]
<a name="l00363"></a>00363     <span class="keywordflow">return</span> cantxbin, mediaxbin
<a name="l00364"></a>00364  
<a name="l00365"></a>00365     
<a name="l00366"></a>00366 
<a name="l00367"></a><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a55606547afe873c79e7365c980522508">00367</a> <span class="keyword">def </span><a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a55606547afe873c79e7365c980522508">difPrimario</a>():
<a name="l00368"></a>00368     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00369"></a>00369 <span class="stringliteral">    Extrae todos los TLEs que contiene la carpeta tle del administrador</span>
<a name="l00370"></a>00370 <span class="stringliteral">    de TLEs. Propaga cada TLEs a la epoca del ultimo del set y calcula </span>
<a name="l00371"></a>00371 <span class="stringliteral">    las diferencias. (falta que sea opcional el sistema de ref)</span>
<a name="l00372"></a>00372 <span class="stringliteral">    NOTA: Transforma los resultados al sistema TOD.</span>
<a name="l00373"></a>00373 <span class="stringliteral">    ----------------------------------------------------------------</span>
<a name="l00374"></a>00374 <span class="stringliteral">    output:</span>
<a name="l00375"></a>00375 <span class="stringliteral">        set de datos ... describir. </span>
<a name="l00376"></a>00376 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00377"></a>00377     tles=glob.glob(<span class="stringliteral">&#39;../TleAdmin/tle/*&#39;</span>)
<a name="l00378"></a>00378     dic_tles=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#ac352fb5d30dae7100bfa677e5a33fb7b">generadorDatos</a>(tles)
<a name="l00379"></a>00379     tle_ordenados=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#af6f0f78d827900de034dde2317641d71">ordenaTles</a>(dic_tles)
<a name="l00380"></a>00380     
<a name="l00381"></a>00381     tle_inicio = Tle.creadoxArchivo(<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tle_ordenados[0][0])
<a name="l00382"></a>00382     cat_id = tle_inicio.catID()
<a name="l00383"></a>00383     epoca_ini = tle_inicio.epoca()
<a name="l00384"></a>00384     
<a name="l00385"></a>00385     <span class="comment">#=========================</span>
<a name="l00386"></a>00386     <span class="comment"># Ultimo TLE del set</span>
<a name="l00387"></a>00387     <span class="comment">#=========================</span>
<a name="l00388"></a>00388     tle_primario = Tle.creadoxArchivo(<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tle_ordenados[-1][0])
<a name="l00389"></a>00389     epoca_fin  = tle_primario.epoca()
<a name="l00390"></a>00390     epoca_ffin = epoca_fin
<a name="l00391"></a>00391     epoca15dias=epoca_ffin-timedelta(days=15)
<a name="l00392"></a>00392     
<a name="l00393"></a>00393     nombre=<span class="stringliteral">&#39;difPri_&#39;</span>+str(cat_id)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ffin.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ini.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;.TLE&#39;</span>
<a name="l00394"></a>00394     nombre2=<span class="stringliteral">&#39;difPri_xyz_&#39;</span>+str(cat_id)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ffin.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;_&#39;</span>+epoca_ini.strftime(<span class="stringliteral">&#39;%Y%m%d&#39;</span>)+<span class="stringliteral">&#39;.TLE&#39;</span>
<a name="l00395"></a>00395     dtot=open(<span class="stringliteral">&#39;../AjustarTLE/diferencias/&#39;</span>+nombre+<span class="stringliteral">&#39;&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00396"></a>00396     dtot2=open(<span class="stringliteral">&#39;../AjustarTLE/diferencias/&#39;</span>+nombre2+<span class="stringliteral">&#39;&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)
<a name="l00397"></a>00397     
<a name="l00398"></a>00398     dt_tle=[]
<a name="l00399"></a>00399     dt_frac=[]
<a name="l00400"></a>00400     dv=[]
<a name="l00401"></a>00401     dn=[]
<a name="l00402"></a>00402     dc=[]
<a name="l00403"></a>00403     dvv=[]
<a name="l00404"></a>00404     dnn=[]
<a name="l00405"></a>00405     dcc=[]
<a name="l00406"></a>00406     dx=[]
<a name="l00407"></a>00407     dy=[]
<a name="l00408"></a>00408     dz=[]
<a name="l00409"></a>00409     dxx=[]
<a name="l00410"></a>00410     dyy=[]
<a name="l00411"></a>00411     dzz=[]
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     tlepri=tle_ordenados[-1][0]
<a name="l00414"></a>00414     r,rp,ffin=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#a94aec4b69038ea33ab79eb7889b35f52">tlePrimario</a>(tlepri) <span class="comment"># En TEME</span>
<a name="l00415"></a>00415     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00416"></a>00416 <span class="stringliteral">    Transformacion del TEME al TOD.</span>
<a name="l00417"></a>00417 <span class="stringliteral">    &quot;&quot;&quot;</span> 
<a name="l00418"></a>00418     r=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#aee17184e86131336dd2574ead19d91cc">teme2tod</a>(ffin, r)
<a name="l00419"></a>00419     r=np.array([r[0,0],r[0,1],r[0,2]])
<a name="l00420"></a>00420     rp=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#aee17184e86131336dd2574ead19d91cc">teme2tod</a>(ffin, rp) 
<a name="l00421"></a>00421     rp=np.array([rp[0,0],rp[0,1],rp[0,2]])
<a name="l00422"></a>00422     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00423"></a>00423 <span class="stringliteral">    fin de la transformacion</span>
<a name="l00424"></a>00424 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00425"></a>00425     item=range(len(tle_ordenados)-2,-1,-1)       
<a name="l00426"></a>00426     <span class="keywordflow">for</span> j <span class="keywordflow">in</span> item:
<a name="l00427"></a>00427         tlesec=tle_ordenados[j][0]
<a name="l00428"></a>00428         tle1=Tle.creadoxArchivo(<span class="stringliteral">&#39;../TleAdmin/tle/&#39;</span>+tlesec)
<a name="l00429"></a>00429         tle1_epoca=tle1.epoca()
<a name="l00430"></a>00430         <span class="keywordflow">if</span> tle1_epoca &gt;= epoca15dias:
<a name="l00431"></a>00431             pos,vel,fsec=<a class="code" href="namespace_ajustar_t_l_e_1_1_ajustar_t_l_e.html#aa9758327fe1e231138181cf4654d0bc3">tleSecundario</a>(tlesec, ffin)
<a name="l00432"></a>00432             <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00433"></a>00433 <span class="stringliteral">            Transformacion del TEME al TOD.</span>
<a name="l00434"></a>00434 <span class="stringliteral">            &quot;&quot;&quot;</span> 
<a name="l00435"></a>00435             pos=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#aee17184e86131336dd2574ead19d91cc">teme2tod</a>(fsec, pos)
<a name="l00436"></a>00436             pos=np.array([pos[0,0],pos[0,1],pos[0,2]])
<a name="l00437"></a>00437             vel=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#aee17184e86131336dd2574ead19d91cc">teme2tod</a>(fsec, vel)
<a name="l00438"></a>00438             vel=np.array([vel[0,0],vel[0,1],vel[0,2]])
<a name="l00439"></a>00439             <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00440"></a>00440 <span class="stringliteral">            fin de la transformacion</span>
<a name="l00441"></a>00441 <span class="stringliteral">            &quot;&quot;&quot;</span>
<a name="l00442"></a>00442             dt_tle.append(fsec)
<a name="l00443"></a>00443             dr=pos-r
<a name="l00444"></a>00444             d_v=vel-rp
<a name="l00445"></a>00445             x=dr[0]
<a name="l00446"></a>00446             y=dr[1]
<a name="l00447"></a>00447             z=dr[2]
<a name="l00448"></a>00448             xx=d_v[0]
<a name="l00449"></a>00449             yy=d_v[1]
<a name="l00450"></a>00450             zz=d_v[2]
<a name="l00451"></a>00451             dt=abs(fsec-ffin)
<a name="l00452"></a>00452             dtfracdias=dt.total_seconds()/86400.0
<a name="l00453"></a>00453             v,n,c=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#a8190e729516e0f1cc25eee08d0303760">vncSis</a>(r, rp, dr)
<a name="l00454"></a>00454             vv,nn,cc=<a class="code" href="namespace_sist_referencia_1_1sist__de_coordenadas.html#a8190e729516e0f1cc25eee08d0303760">vncSis</a>(r,rp,d_v)
<a name="l00455"></a>00455     <span class="comment">#             v,n,c=ricSis(r, rp, dr)</span>
<a name="l00456"></a>00456     <span class="comment">#             vv,nn,cc=ricSis(r,rp,dv)</span>
<a name="l00457"></a>00457             infodifpri=str(fsec)+<span class="stringliteral">&#39; &#39;</span>+str(v)+<span class="stringliteral">&#39; &#39;</span>+str(n)+<span class="stringliteral">&#39; &#39;</span>+str(c)+<span class="stringliteral">&#39; &#39;</span>+str(vv)+<span class="stringliteral">&#39; &#39;</span>+str(nn)+<span class="stringliteral">&#39; &#39;</span>+str(cc)+<span class="stringliteral">&#39; &#39;</span>+tlesec+<span class="stringliteral">&#39;\n&#39;</span>
<a name="l00458"></a>00458             infodifpri2=str(fsec)+<span class="stringliteral">&#39; &#39;</span>+str(x)+<span class="stringliteral">&#39; &#39;</span>+str(y)+<span class="stringliteral">&#39; &#39;</span>+str(z)+<span class="stringliteral">&#39; &#39;</span>+str(xx)+<span class="stringliteral">&#39; &#39;</span>+str(yy)+<span class="stringliteral">&#39; &#39;</span>+str(zz)+<span class="stringliteral">&#39; &#39;</span>+tlesec+<span class="stringliteral">&#39;\n&#39;</span>
<a name="l00459"></a>00459             dtot.write(infodifpri)
<a name="l00460"></a>00460             dtot2.write(infodifpri2)
<a name="l00461"></a>00461             dt_frac.append(dtfracdias)
<a name="l00462"></a>00462             <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00463"></a>00463 <span class="stringliteral">            Sistema VNC</span>
<a name="l00464"></a>00464 <span class="stringliteral">            &#39;&#39;&#39;</span>
<a name="l00465"></a>00465             dv.append(v)
<a name="l00466"></a>00466             dn.append(n)
<a name="l00467"></a>00467             dc.append(c)
<a name="l00468"></a>00468             dvv.append(vv)
<a name="l00469"></a>00469             dnn.append(nn)
<a name="l00470"></a>00470             dcc.append(cc)
<a name="l00471"></a>00471             <span class="stringliteral">&#39;&#39;&#39;</span>
<a name="l00472"></a>00472 <span class="stringliteral">            Sistema TEME</span>
<a name="l00473"></a>00473 <span class="stringliteral">            &#39;&#39;&#39;</span>
<a name="l00474"></a>00474             dx.append(x)
<a name="l00475"></a>00475             dy.append(y)
<a name="l00476"></a>00476             dz.append(z)
<a name="l00477"></a>00477             dxx.append(xx)
<a name="l00478"></a>00478             dyy.append(yy)
<a name="l00479"></a>00479             dzz.append(zz)       
<a name="l00480"></a>00480             
<a name="l00481"></a>00481     data1=[dt_tle,dv,dn,dc,dvv,dnn,dnn,dt_frac]
<a name="l00482"></a>00482     var_v=np.var(dv)
<a name="l00483"></a>00483     var_n=np.var(dn)
<a name="l00484"></a>00484     var_c=np.var(dc)
<a name="l00485"></a>00485     
<a name="l00486"></a>00486     <span class="keywordflow">print</span> <span class="stringliteral">&#39;*******************************************************&#39;</span>
<a name="l00487"></a>00487     <span class="keywordflow">print</span> <span class="stringliteral">&#39;-----------------Varianzas---------------------------&#39;</span>
<a name="l00488"></a>00488     <span class="keywordflow">print</span> <span class="stringliteral">&#39;*******************************************************&#39;</span>
<a name="l00489"></a>00489     <span class="keywordflow">print</span> <span class="stringliteral">&#39;Var en R = &#39;</span>, var_v
<a name="l00490"></a>00490     <span class="keywordflow">print</span> <span class="stringliteral">&#39;Var en T = &#39;</span>, var_n
<a name="l00491"></a>00491     <span class="keywordflow">print</span> <span class="stringliteral">&#39;Var en N = &#39;</span>, var_c
<a name="l00492"></a>00492     
<a name="l00493"></a>00493 <span class="comment">#     print &#39;++++++++++++GRADO 2++++++++++++++++++&#39;</span>
<a name="l00494"></a>00494     dt,coef,statsReport=<a class="code" href="namespace_estadistica_1_1ajuste_min_cuad.html#aa33554754bf43adc6df315cff92367e1">ajustar_diferencias</a>(epoca_ffin,data1,2)
<a name="l00495"></a>00495 <span class="comment">#     print coef</span>
<a name="l00496"></a>00496 <span class="comment">#     print statsReport</span>
<a name="l00497"></a>00497 <span class="comment">#     </span>
<a name="l00498"></a>00498 <span class="comment">#     print &#39;++++++++++++GRADO 1++++++++++++++++++&#39;</span>
<a name="l00499"></a>00499     dt1,coef1,statsReport1=<a class="code" href="namespace_estadistica_1_1ajuste_min_cuad.html#aa33554754bf43adc6df315cff92367e1">ajustar_diferencias</a>(epoca_ffin,data1,1)
<a name="l00500"></a>00500 <span class="comment">#     print coef1</span>
<a name="l00501"></a>00501 <span class="comment">#     print statsReport1</span>
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     data=[dt,data1,coef,nombre]  
<a name="l00504"></a>00504     dtot.close()
<a name="l00505"></a>00505     dtot2.close() 
<a name="l00506"></a>00506 
<a name="l00507"></a>00507     <span class="keywordflow">return</span> data     
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="comment"># if __name__==&#39;__main__&#39;:</span>
<a name="l00510"></a>00510 <span class="comment"># #    ejecuta_procesamiento_TLE():</span>
<a name="l00511"></a>00511 <span class="comment">#     &quot;&quot;&quot;</span>
<a name="l00512"></a>00512 <span class="comment">#     Se crean los directorios necesarios.</span>
<a name="l00513"></a>00513 <span class="comment">#     &quot;&quot;&quot;</span>
<a name="l00514"></a>00514 <span class="comment"># </span>
<a name="l00515"></a>00515 <span class="comment">#     d1=&#39;../TleAdmin/tle&#39;</span>
<a name="l00516"></a>00516 <span class="comment">#     if not os.path.exists(d1):</span>
<a name="l00517"></a>00517 <span class="comment">#         os.mkdir(d1)</span>
<a name="l00518"></a>00518 <span class="comment">#     d2=&#39;../AjustarTLE/diferencias&#39;</span>
<a name="l00519"></a>00519 <span class="comment">#     if not os.path.exists(d2):</span>
<a name="l00520"></a>00520 <span class="comment">#         os.mkdir(d2)</span>
<a name="l00521"></a>00521 <span class="comment">#     d3=&#39;../main/matrices/&#39;</span>
<a name="l00522"></a>00522 <span class="comment">#     if not os.path.exists(d3):</span>
<a name="l00523"></a>00523 <span class="comment">#         os.mkdir(d3)</span>
<a name="l00524"></a>00524 <span class="comment">#     d4=&#39;../visual/archivos&#39;</span>
<a name="l00525"></a>00525 <span class="comment">#     if not os.path.exists(d4):</span>
<a name="l00526"></a>00526 <span class="comment">#         os.mkdir(d4)</span>
<a name="l00527"></a>00527 <span class="comment">#         </span>
<a name="l00528"></a>00528 <span class="comment">#     files=glob.glob(&#39;../AjustarTLE/diferencias/*&#39;)</span>
<a name="l00529"></a>00529 <span class="comment">#     for filename in files:</span>
<a name="l00530"></a>00530 <span class="comment">#         os.unlink(filename)</span>
<a name="l00531"></a>00531 <span class="comment">#         </span>
<a name="l00532"></a>00532 <span class="comment">#     self.bin=difTle(self.tleOrdenados, self.tles)</span>
<a name="l00533"></a>00533 <span class="comment">#     self.cantxbin,self.mediaxbin=genera_estadisticaBin(self.bin)</span>
<a name="l00534"></a>00534 <span class="comment">#     self.diferencias=difPrimario(self.filename,self.tles-1)</span>
<a name="l00535"></a>00535 <span class="comment"># </span>
<a name="l00536"></a>00536 <span class="comment">#     t=[]</span>
<a name="l00537"></a>00537 <span class="comment">#     dv=[]</span>
<a name="l00538"></a>00538 <span class="comment">#     dn=[]</span>
<a name="l00539"></a>00539 <span class="comment">#     dc=[]</span>
<a name="l00540"></a>00540 <span class="comment">#     </span>
<a name="l00541"></a>00541 <span class="comment">#     </span>
<a name="l00542"></a>00542 <span class="comment">#     archivo=open(&#39;../AjustarTLE/diferencias/difTotal&#39;,&#39;r&#39;)</span>
<a name="l00543"></a>00543 <span class="comment">#     contenido=archivo.readlines()</span>
<a name="l00544"></a>00544 <span class="comment">#     </span>
<a name="l00545"></a>00545 <span class="comment">#     for c in contenido:</span>
<a name="l00546"></a>00546 <span class="comment">#         campos=c.split(&#39;,&#39;)</span>
<a name="l00547"></a>00547 <span class="comment">#         t.append(float(campos[0]))</span>
<a name="l00548"></a>00548 <span class="comment">#         dv.append(float(campos[1]))</span>
<a name="l00549"></a>00549 <span class="comment">#         dn.append(float(campos[2]))</span>
<a name="l00550"></a>00550 <span class="comment">#         dc.append(float(campos[3]))</span>
<a name="l00551"></a>00551 <span class="comment">#         </span>
<a name="l00552"></a>00552 <span class="comment">#     c, b, a = P.polynomial.polyfit(t, dv, deg=2)</span>
<a name="l00553"></a>00553 <span class="comment">#     print c,b,a</span>
<a name="l00554"></a>00554 <span class="comment">#     </span>
<a name="l00555"></a>00555 <span class="comment">#     x=np.linspace(0,30, 60)</span>
<a name="l00556"></a>00556 <span class="comment">#     y=[]</span>
<a name="l00557"></a>00557 <span class="comment">#     for i in x:</span>
<a name="l00558"></a>00558 <span class="comment">#         y.append(-0.002373*i*i+0.061160*i-0.077031)</span>
<a name="l00559"></a>00559 <span class="comment">#     </span>
<a name="l00560"></a>00560 <span class="comment">#     plt.plot(t,dv,&#39;x&#39;)</span>
<a name="l00561"></a>00561 <span class="comment">#     plt.plot(x,y,&#39;-&#39;)</span>
<a name="l00562"></a>00562 <span class="comment">#     plt.show()</span>
<a name="l00563"></a>00563     
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">#     &quot;&quot;&quot;</span>
<a name="l00566"></a>00566 <span class="comment">#     Verificacion de generacion del archivo con las diferencias</span>
<a name="l00567"></a>00567 <span class="comment">#     &quot;&quot;&quot;</span>
<a name="l00568"></a>00568 <span class="comment">#     print &#39;---------------------------------------------------------------------------------&#39;</span>
<a name="l00569"></a>00569 <span class="comment">#     print &quot;Verifiacion de la Generacion del archivo de diferencias: &quot;,salida</span>
<a name="l00570"></a>00570 <span class="comment">#     print &quot;Ultima modificacion %s&quot; % time.ctime(os.path.getmtime(&#39;../AjustarTLE/diferencias/difTotal&#39;))</span>
<a name="l00571"></a>00571 <span class="comment">#     print &quot;creado: %s&quot; % time.ctime(os.path.getctime(&#39;../AjustarTLE/diferencias/difTotal&#39;))</span>
<a name="l00572"></a>00572 <span class="comment">#     print &#39; &#39;</span>
<a name="l00573"></a>00573 <span class="comment">#     print &#39; &#39;</span>
<a name="l00574"></a>00574 <span class="comment">#     &quot;&quot;&quot;</span>
<a name="l00575"></a>00575 <span class="comment">#     generacion de graficos</span>
<a name="l00576"></a>00576 <span class="comment">#     &quot;&quot;&quot; </span>
<a name="l00577"></a>00577         <span class="comment"># gegrafTot(&#39;../AjustarTLE/diferencias/difTotal&#39;+setID,setID)</span>
<a name="l00578"></a>00578     
<a name="l00579"></a>00579     <span class="comment">#     #gegraf(&#39;../AjustarTLE/diferencias/diferencias&#39;+tlepri,tlepri)</span>
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_ajustar_t_l_e_8py.html">AjustarTLE.py</a>      </li>

    <li class="footer">Generated on Thu Jul 13 2017 12:06:31 for ARxCODE by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
